# Diffusion Flow Experiments

Playground for implementing papers on diffusion models and flow matching.

![CFM Loss with Ïˆ](https://latex.codecogs.com/svg.image?\dpi{200}\bg_white%20\displaystyle%20\mathcal{L}_{\mathrm{CFM}}(\theta)%20=%20\mathbb{E}_{t,%20q(x_1),%20p(x_0)}%20\big\lVert%20v_t(\psi_t(x_0))%20-%20\frac{d}{dt}\psi_t(x_0)\big\rVert^2)


![image](https://github.com/user-attachments/assets/58db0571-dc33-40d5-a884-621d92066164)

Eventually, I'll move on to more expensive experiments with image, audio and video generation.


<details>
  <summary>
  
  ## 1. Perturbed Noise Conditioned Score Network</strong>
  
  </summary>

  Paper: [Generative Modeling by Estimating Gradients of the Data Distribution](https://arxiv.org/abs/1907.05600)

  [Notebook](https://github.com/avramdj/diffy/blob/main/src/1_perturbed_ncsn.ipynb)
  
  
  ### The vector field generated by the NCSN
  
  ![image1](https://github.com/user-attachments/assets/5affd982-6646-48cb-bd39-88714be8a80e)
  
  ### Sampling via langevin dynamics
  
  ![image2](https://github.com/user-attachments/assets/ea38069a-4457-4d7e-8b23-97f1e08f143f)

</details>


<details>
  <summary>
  
  ## 2. Rectified Flow</strong>
  
  </summary>

  Paper: [Flow Straight and Fast: Learning to Generate and Transfer Data with Rectified Flow](https://arxiv.org/abs/2209.03003)
  
  Paper: [Flow Matching for Generative Modeling](https://arxiv.org/abs/2210.02747)

  [Notebook](https://github.com/avramdj/diffy/blob/main/src/2_rectified_flow.ipynb)
  
  
  ### Flow Matching
  
  ![image](https://github.com/user-attachments/assets/58db0571-dc33-40d5-a884-621d92066164)
  
  ### Rectified Flow with straight trajectories - 2nd reflow iteration

  ![image](https://github.com/user-attachments/assets/89ef9310-7efa-4280-a4b0-acb98508e1a5)

</details>


